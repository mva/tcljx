;; Copyright (c) Michael van Acken. All rights reserved.
;; The use and distribution terms for this software are covered by the
;; Eclipse Public License 2.0 (https:;;www.eclipse.org/legal/epl-v20.html)
;; which can be found in the file epl-v20.html at the root of this distribution.
;; By using this software in any fashion, you are agreeing to be bound by
;; the terms of this license.
;; You must not remove this notice, or any other, from this software.
(ns tcljx.run-tests
  (:require
   (tcljx.alpha textflow__pp-test ptest__align-test ptest-test)
   (tcljx.parser reader-test)
   (tcljx.nmspgen bootstrap-test invoke-test unreachable-test
                   const-test conv-test prim-conv-test dot-form-test new-test
                   arith-test let-test quote-test meta-test str-test bits-test
                   array-test clone-test switch-test cond-test logic-test
                   xcmp-test try-test loop-test unboxing-test boxing-test
                   fn-member-test fn-test definterface-test itf-fn-test xjunction-test
                   deftype-test record-test reify-test letfn-test closure-test
                   variadic-test main-test macro-test rtiow-nocore-test
                   namespace-test set-test line-test require-test)
   tcljx.main                      ;at least compile unused namespaces
   [tcljx.alpha.ptest :refer [run-scoped-tests]]))

(def all-namespaces
  '[tcljx.alpha.ptest-test
    tcljx.alpha.textflow__pp-test
    tcljx.alpha.ptest__align-test
    
    tcljx.parser.reader-test
    tcljx.nmspgen.bootstrap-test
    tcljx.nmspgen.invoke-test
    tcljx.nmspgen.unreachable-test
    tcljx.nmspgen.const-test
    tcljx.nmspgen.conv-test
    tcljx.nmspgen.prim-conv-test
    tcljx.nmspgen.dot-form-test
    tcljx.nmspgen.new-test
    tcljx.nmspgen.arith-test
    tcljx.nmspgen.let-test
    tcljx.nmspgen.quote-test
    tcljx.nmspgen.meta-test
    tcljx.nmspgen.str-test
    tcljx.nmspgen.bits-test
    tcljx.nmspgen.array-test
    tcljx.nmspgen.clone-test
    tcljx.nmspgen.switch-test
    tcljx.nmspgen.cond-test
    tcljx.nmspgen.logic-test
    tcljx.nmspgen.xcmp-test
    tcljx.nmspgen.try-test
    tcljx.nmspgen.loop-test
    tcljx.nmspgen.unboxing-test
    tcljx.nmspgen.boxing-test
    tcljx.nmspgen.fn-member-test
    tcljx.nmspgen.fn-test
    tcljx.nmspgen.definterface-test
    tcljx.nmspgen.itf-fn-test
    tcljx.nmspgen.xjunction-test
    tcljx.nmspgen.deftype-test
    tcljx.nmspgen.record-test
    tcljx.nmspgen.reify-test
    tcljx.nmspgen.letfn-test
    tcljx.nmspgen.closure-test
    tcljx.nmspgen.variadic-test
    tcljx.nmspgen.main-test
    tcljx.nmspgen.macro-test
    tcljx.nmspgen.rtiow-nocore-test
    tcljx.nmspgen.namespace-test
    tcljx.nmspgen.set-test
    tcljx.nmspgen.line-test
    tcljx.nmspgen.require-test])

(defn run []
  (run-scoped-tests all-namespaces))

(defn -main [& args]
  (try
    (apply run args)
    (finally
      (shutdown-agents))))     ;can only shut down when owning the JVM
