;; Copyright (c) Michael van Acken. All rights reserved.
;; The use and distribution terms for this software are covered by the
;; Eclipse Public License 2.0 (https:;;www.eclipse.org/legal/epl-v20.html)
;; which can be found in the file epl-v20.html at the root of this distribution.
;; By using this software in any fashion, you are agreeing to be bound by
;; the terms of this license.
;; You must not remove this notice, or any other, from this software.
(ns tcljx.run-tests
  (:require
   (tcljx.alpha ptest-test)
   (tcljx reader-test synquote-test #_grammar-test

          #_invoke-test #_bootstrap-test
          
          #_const-test #_conv-test #_prim-conv-test #_dot-form-test #_new-test #_arith-test
          #_let-test #_quote-test #_meta-test #_str-test #_bits-test #_switch-test #_cond-test
          #_try-test #_array-test #_loop-test #_logic-test #_clone-test #_xcmp-test
          #_unboxing-test #_boxing-test #_fn-member-test

          #_namespace-test #_fn-test #_itf-fn-test #_variadic-test #_macro-test
          #_deftype-test #_record-test #_set-test #_definterface-test #_closure-test
          #_line-test #_letfn-test #_reify-test #_require-test #_main-test

          #_rtiow-nocore-test)
   
   tcljx.main                      ;at least compile unused namespaces
   
   [tcljx.alpha.ptest :refer [run-scoped-tests]]))

(def all-namespaces
  '[tcljx.alpha.ptest-test
    
    tcljx.reader-test
    tcljx.synquote-test
    #_tcljx.grammar-test

    #_tcljx.invoke-test
    #_tcljx.bootstrap-test
    
    #_tcljx.const-test
    #_tcljx.conv-test
    #_tcljx.prim-conv-test
    #_tcljx.dot-form-test
    #_tcljx.new-test
    #_tcljx.arith-test
    #_tcljx.let-test
    #_tcljx.quote-test
    #_tcljx.meta-test
    #_tcljx.str-test
    #_tcljx.bits-test
    #_tcljx.switch-test
    #_tcljx.cond-test
    #_tcljx.try-test
    #_tcljx.array-test
    #_tcljx.loop-test
    #_tcljx.logic-test
    #_tcljx.clone-test
    #_tcljx.xcmp-test
    #_tcljx.unboxing-test
    #_tcljx.boxing-test
    #_tcljx.fn-member-test

    #_tcljx.namespace-test
    #_tcljx.fn-test
    #_tcljx.itf-fn-test
    #_tcljx.variadic-test
    #_tcljx.macro-test
    #_tcljx.deftype-test
    #_tcljx.record-test
    #_tcljx.set-test
    #_tcljx.definterface-test
    #_tcljx.closure-test
    #_tcljx.line-test
    #_tcljx.letfn-test
    #_tcljx.reify-test
    #_tcljx.require-test
    #_tcljx.main-test

    #_tcljx.rtiow-nocore-test])

(defn run []
  (run-scoped-tests all-namespaces))

(defn -main [& args]
  (try
    (apply run args)
    (finally
      (shutdown-agents))))     ;can only shut down when owning the JVM
